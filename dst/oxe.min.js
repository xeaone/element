/*
	Name: oxe
	Version: 5.2.8
	License: MPL-2.0
	Author: Alexander Elias
	Email: alex.steven.elis@gmail.com
	This Source Code Form is subject to the terms of the Mozilla Public
	License, v. 2.0. If a copy of the MPL was not distributed with this
	file, You can obtain one at http://mozilla.org/MPL/2.0/.
*/
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self,e.Oxe=t())})(this,function(){"use strict";function e(e,t){if("on"===e.type)return t;if(!e.pipes.length)return t;var a=e.container.methods;if(!a)return t;for(var n,r=0,i=e.pipes.length;r<i;r++)if(n=e.pipes[r],n in a){var d=a[n];d&&d.constructor===Function?t=a[n].call(e.container,t):console.warn("Oxe.piper - pipe ".concat(n," invalid type"))}else console.warn("Oxe.piper - pipe ".concat(n," not found"));return t}function t(e){return{read:function(){if(this.data=e.data,this.data===e.target.disabled)return!1},write:function(){e.target.disabled=this.data}}}function a(e){return{read:function(){if(this.data=!e.data,this.data===e.target.disabled)return!1},write:function(){e.target.disabled=this.data}}}function n(e){return{read:function(){if(this.data=e.data,this.data===e.target.hidden)return!1},write:function(){e.target.hidden=this.data}}}function r(e){return{read:function(){if(this.data=e.data,this.data===e.target.required)return!1},write:function(){e.target.required=this.data}}}function i(e){return{read:function(){if(this.data=e.data,!this.data===e.target.hidden)return!1},write:function(){e.target.hidden=!this.data}}}function d(e){return{read:function(){if(this.data=e.data,1<e.names.length){this.name="",this.names=e.names.slice(1);for(var t=0,a=this.names.length;t<a;t++)0===t?this.name=this.names[t].toLowerCase():this.name+=this.names[t].charAt(0).toUpperCase()+this.names[t].slice(1).toLowerCase()}},write:function(){1<e.names.length?this.data?e.target.style[this.name]=this.data:e.target.style[this.name]="":this.data?e.target.style.cssText=this.data:e.target.style.cssText=""}}}function l(e){return new Promise(function(t){if("attributes"in e.target&&"o-value"in e.target.attributes){var a=f.get("attribute",e.target,"o-value");f.render(a,"view")}return t()})}function o(e){return new Promise(function(t,a){var n,r,d,i,l,o,s,c,p,h,u,m;if(!1===e.target.hasAttribute("o-submit"))return t();for(e.preventDefault(),n={},r=e.target.querySelectorAll("*"),(d=0,i=r.length);d<i;d++)(l=r[d],o=l.type,(o||"TEXTAREA"===p)&&"submit"!==o&&"button"!==o&&o)&&(s=f.get("attribute",l,"o-value"),c=s?s.data:l.files?l.attributes.multiple?Array.prototype.slice.call(l.files):l.files[0]:l.value,p=l.name||(s?s.values[s.values.length-1]:null),p&&(n[p]=c));return h=f.get("attribute",e.target,"o-submit"),Promise.resolve(h.data.call(h.container,n,e)).then(function(n){try{function r(){return(e.target.hasAttribute("o-reset")||"object"===_typeof(u)&&u.reset)&&e.target.reset(),t()}return u=n,"object"===_typeof(u)?(u.url=u.url||e.target.getAttribute("o-action"),u.method=u.method||e.target.getAttribute("o-method"),u.contentType=u.contentType||e.target.getAttribute("o-enctype"),Promise.resolve(y.fetch(u)).then(function(e){try{function t(){return r.call(this)}return m=e,u.handler?Promise.resolve(u.handler(m)).then(function(){try{return t.call(this)}catch(e){return a(e)}}.bind(this),a):t.call(this)}catch(e){return a(e)}}.bind(this),a)):r.call(this)}catch(e){return a(e)}}.bind(this),a)})}function s(e){return new Promise(function(t){if("radio"!==e.target.type&&"option"!==e.target.type&&"checkbox"!==e.target.type&&"select-one"!==e.target.type&&"select-multiple"!==e.target.type&&"attributes"in e.target&&"o-value"in e.target.attributes){var a=f.get("attribute",e.target,"o-value");f.render(a,"view")}return t()})}function c(e){return new Promise(function(t){if(!1===e.target.hasAttribute("o-reset"))return t();e.preventDefault();for(var a=e.target.querySelectorAll("*"),n=0,r=a.length;n<r;n++){var i=a[n],d=i.nodeName,l=i.type;if((l||"TEXTAREA"===d)&&"submit"!==l&&"button"!==l&&l){var o=f.get("attribute",i,"o-value");o?"select-one"===l?o.data=null:"select-multiple"===l?o.data=[]:"radio"===l||"checkbox"===l?o.data=!1:o.data="":"select-one"===l||"select-multiple"===l?i.selectedIndex=null:"radio"===l||"checkbox"===l?i.checked=!1:i.value=null}}return t()})}function p(e,t,a){var n,r,i=a.type;i in e.listener&&(n="function"==typeof e.listener[i].before?e.listener[i].before.bind(null,a):null,r="function"==typeof e.listener[i].after?e.listener[i].after.bind(null,a):null),Promise.resolve().then(n).then(t.bind(null,a)).then(r)}var h,u={PIPE:/\s?\|\s?/,PIPES:/\s?,\s?|\s+/,value:function(e,t){if(!t)throw new Error("Utility.value - requires model argument");if(!e)throw new Error("Utility.value - requires element argument");var a=this.type(e);if("radio"===a||"checkbox"===a){for(var n=this.name(e),r=this.form(e),d=r?this.form(e).querySelectorAll("input[type=\""+a+"\"][name=\""+n+"\"]"):[e],o=1<d.length,s=o?[]:void 0,c=0,i=d.length;c<i;c++){var l=d[c],p=this.checked(l);if(p){var h=this.value(l,t);if(o)s.push(h);else{s=h;break}}}return s}if("select-one"===a||"select-multiple"===a){for(var u=this.multiple(e),m=e.options,g=u?[]:void 0,b=0,f=m.length;b<f;b++){var y=m[b],v=y.selected,x=this.value(y,t),k=this[u?"includes":"compare"](this.data,x);v&&!k?this.multiple?g.push(x):g=x:!v&&k&&(y.selected=!0)}return g}var E=e.attributes["o-value"];if(E){var O=this.binderValues(E.value),w=this.getByPath(t,O);return w||e.value}return e.value},form:function(e){if(e.form)return e.form;for(;e=e.parentElement;)if("FORM"===e.nodeName||-1!==e.nodeName.indexOf("-FORM"))return e},type:function(e){return"string"==typeof e.type?e.type:e.getAttribute("type")},name:function(e){return"string"==typeof e.name?e.name:e.getAttribute("name")},checked:function(e){if("boolean"==typeof e.checked)return e.checked;switch(e.getAttribute("checked")){case void 0:return!1;case"true":return!0;case null:return!1;case"":return!0;default:return!1;}},multiple:function(e){if("boolean"==typeof e.multiple)return e.multiple;switch(e.getAttribute("multiple")){case void 0:return!1;case"true":return!0;case null:return!1;case"":return!0;default:return!1;}},disabled:function(e){if("boolean"==typeof e.disabled)return e.disabled;switch(e.getAttribute("disabled")){case void 0:return!1;case"true":return!0;case null:return!1;case"":return!0;default:return!1;}},index:function(e,t){for(var a=0,n=e.length;a<n;a++)if(this.match(e[a],t))return a;return-1},includes:function(e,t){for(var a=0,n=e.length;a<n;a++)if(this.match(e[a],t))return!0;return!1},match:function(e,t){if(e===t)return!0;if(null===e||void 0===e)return!1;if(null===t||void 0===t)return!1;if(_typeof(e)!==_typeof(t))return!1;if(e.constructor!==t.constructor)return!1;if("object"!==_typeof(e)||"object"!==_typeof(t))return e===t;var a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;for(var r,d=0,i=a.length;d<i;d++)if(r=a[d],!this.match(e[r],t[r]))return!1;return!0},binderNames:function(e){return e=e.split("o-")[1],e?e.split("-"):[]},binderValues:function(e){return e=e.split(this.PIPE)[0],e?e.split("."):[]},binderPipes:function(e){return e=e.split(this.PIPE)[1],e?e.split(this.PIPES):[]},ensureElement:function(e){e.query=e.query||"",e.scope=e.scope||document.body,e.position=e.position||"beforeend";var t=e.scope.querySelector("".concat(e.name).concat(e.query));t||(t=document.createElement(e.name),e.scope.insertAdjacentElement(e.position,t));for(var a=0,n=e.attributes.length;a<n;a++){var r=e.attributes[a],i=r.name,d=r.value;t.setAttribute(i,d)}return t},setByPath:function(e,t,a){for(var n,r="string"==typeof t?t.split("."):t,d=r.length-1,l=0;l<d;l++)n=r[l],n in e||(isNaN(r[l+1])?e[n]={}:e[n]=[]),e=e[n];return e[r[d]]=a},getByPath:function(e,t){var a="string"==typeof t?t.split("."):t,n=a.length-1;if("$key"===a[n]||"$index"===a[n])return a[n-1];for(var r,d=0;d<n;d++){if(r=a[d],!1==r in e)return;e=e[r]}return e[a[n]]},clone:function(e){if(null===e||e===void 0||e.constructor!==Array&&e.constructor!==Object)return e;var t=e.constructor();for(var a in e){var n=Object.getOwnPropertyDescriptor(e,a);n&&("value"in n&&(n.value=this.clone(n.value)),Object.defineProperty(t,a,n))}return t}},m={reads:[],writes:[],time:1e3/30,pending:!1,setup:function(e){e=e||{},this.time=e.time||this.time},tick:function(e){window.requestAnimationFrame(e.bind(this,null))},schedule:function(){this.pending||(this.pending=!0,this.tick(this.flush))},flush:function(e){e=e||performance.now();var t;if(0===this.writes.length)for(;t=this.reads.shift();)if(t&&t(),performance.now()-e>this.time)return this.tick(this.flush);for(;t=this.writes.shift();)if(t&&t(),performance.now()-e>this.time)return this.tick(this.flush);0===this.reads.length&&0===this.writes.length?this.pending=!1:performance.now()-e>this.time?this.tick(this.flush):this.flush(e)},remove:function(e,t){var a=e.indexOf(t);return!!~a&&!!e.splice(a,1)},clear:function(e){return this.remove(this.reads,e)||this.remove(this.writes,e)},batch:function(e){var t=this;if(e&&(e.read||e.write)){e.context=e.context||{};var a=function(){var a;if(e.read&&(a=e.read.call(e.context,e.context)),e.write&&!1!==a){var n=e.write.bind(e.context,e.context);t.writes.push(n)}};t.reads.push(a),t.schedule()}}},g=new Map,b={class:function(e){return{read:function(){this.data=e.data,1<e.names.length&&(this.name=e.names.slice(1).join("-"))},write:function(){this.name?this.data===void 0||null===this.data?e.target.classList.remove(this.name):e.target.classList.toggle(this.name,this.data):this.data===void 0||null===this.data?e.target.setAttribute("class",""):e.target.setAttribute("class",this.data)}}},css:d,default:function(e){return{read:function(){if(this.data=e.data,void 0===this.data||null===this.data?this.data="":"object"===_typeof(this.data)?this.data=JSON.stringify(this.data):"string"!=typeof this.data&&(this.data=this.data.toString()),this.data===e.target[e.type])return!1},write:function(){e.target[e.type]=this.data}}},disable:t,disabled:t,each:function(e){var t=this,a={read:function(){if(this.data=e.data||[],void 0===e.meta.keys)if(e.meta.keys=[],e.meta.pending=!1,e.meta.targetLength=0,e.meta.currentLength=0,e.target.firstElementChild)e.meta.template=e.target.removeChild(e.target.firstElementChild);else{var t=document.createElement("div"),a=document.createTextNode("{{$".concat(e.names[1],"}}"));t.appendChild(a),e.meta.template=t}return(e.meta.keys=Object.keys(this.data),e.meta.targetLength=e.meta.keys.length,e.meta.currentLength!==e.meta.targetLength)&&void 0},write:function(){if(e.meta.currentLength===e.meta.targetLength)return void(e.meta.pending=!1);if(e.meta.currentLength>e.meta.targetLength){var n=e.target.lastElementChild;e.target.removeChild(n),t.remove(n),e.meta.currentLength--}else if(e.meta.currentLength<e.meta.targetLength){var r=e.meta.template.cloneNode(!0),i=e.meta.currentLength++;t.add(r,{index:i,path:e.path,variable:e.names[1],container:e.container,scope:e.container.scope,key:e.meta.keys[i]}),e.target.appendChild(r)}e.meta.pending&&a.read||(e.meta.pending=!0,delete a.read,m.batch(a))}};return a},enable:a,enabled:a,hide:n,hidden:n,href:function(e){return{read:function(){if(this.data=e.data||"",this.data===e.target.href)return!1},write:function(){e.target.href=this.data}}},html:function(e){var t=this;return{read:function(){this.data=e.data,this.data===void 0||null===this.data?this.data="":"object"===_typeof(this.data)?this.data=JSON.stringify(this.data):"string"!=typeof this.data&&(this.data=this.data+"")},write:function(){for(;e.target.firstChild;){var a=e.target.removeChild(e.target.firstChild);t.remove(a)}var n=document.createDocumentFragment(),r=document.createElement("div");for(r.innerHTML=this.data;r.firstElementChild;)t.add(r.firstElementChild,{container:e.container,scope:e.container.scope}),n.appendChild(r.firstElementChild);e.target.appendChild(n)}}},label:function(e){return{read:function(){if(this.data=e.data,void 0===this.data||null===this.data?this.data="":"object"===_typeof(this.data)?this.data=JSON.stringify(this.data):"string"!=typeof this.data&&(this.data=this.data.toString()),this.data===e.target.getAttribute("label"))return!1},write:function(){e.target.setAttribute("label",this.data)}}},on:function(e){return{read:function(t){return t.data=e.data,"function"==typeof t.data?void(e.meta.method?e.target.removeEventListener(e.names[1],e.meta.method):e.meta.method=function(a){for(var n=[],r=0,i=e.pipes.length;r<i;r++){var d=e.pipes[r].split("."),l=u.getByPath(e.container.model,d);n.push(l)}n.push(a),n.push(this),Promise.resolve(t.data.bind(e.container).apply(null,n))},e.target.addEventListener(e.names[1],e.meta.method)):void console.warn("Oxe - binder o-on=\"".concat(e.keys.join("."),"\" invalid type function required"))}}},read:function(e){return{read:function(){if(this.data=e.data,this.data===e.target.readOnly)return!1},write:function(){e.target.readOnly=this.data}}},require:r,required:r,show:i,showed:i,style:d,text:function(e){return{read:function(){if(this.data=e.data,void 0===this.data||null===this.data?this.data="":"object"===_typeof(this.data)?this.data=JSON.stringify(this.data):"string"!=typeof this.data&&(this.data=this.data.toString()),this.data===e.target.textContent)return!1},write:function(){e.target.textContent=this.data}}},value:function(e,t){var a=this,n=e.target.type;if(!e.meta.busy)return e.meta.busy=!0,"select-one"===n||"select-multiple"===n?{read:function(){if(this.data=e.data,this.model=e.model,this.options=e.target.options,this.multiple=u.multiple(e.target),this.multiple&&(!this.data||this.data.constructor!==Array))throw e.meta.busy=!1,new Error("Oxe - invalid o-value ".concat(e.keys.join(".")," multiple select requires array"))},write:function(){for(var n=!1,r=!1,d=this.multiple?[]:null,o=this.multiple?[]:null,s=0,i=this.options.length;s<i;s++){var l=this.options[s],c=l.selected,p=a.get("attribute",l,"o-value"),h=p?p.data:l.value,m=l.hasAttribute("selected");if(this.multiple?m&&(n=!0,o.push(l),d.push(h)):(0===s||m)&&(n=!0,o=l,d=h,r=m),"view"===t){if(c){if(this.multiple){var g=u.includes(this.data,h);g||(this.selected=!0,e.data.push(h))}else this.selected||(this.selected=!0,e.data=h);}else if(this.multiple){var b=u.index(this.data,h);-1!==b&&e.data.splice(b,1)}else this.selected||s!==i-1||(e.data=null);}else if(this.multiple){var f=u.includes(this.data,h);f?(this.selected=!0,l.selected=!0):l.selected=!1}else if(!this.selected){var y=u.match(this.data,h);y?(this.selected=!0,l.selected=!0):l.selected=!1}else l.selected=!1}if(!this.selected&&n)if(this.multiple)for(var v=0,x=o.length;v<x;v++)o[v].selected=!0,e.data.push(d[v]);else(r||"OPTION"===this.nodeName)&&(e.data=d,o.selected=!0);e.meta.busy=!1}}:"radio"===n?{read:function(){return(this.form=e.target.form||e.container,this.query="input[type=\"radio\"][o-value=\"".concat(e.value,"\"]"),this.nodes=this.form.querySelectorAll(this.query),this.radios=Array.prototype.slice.call(this.nodes),"view"===t)?(e.data=this.radios.indexOf(e.target),e.meta.busy=!1,!1):(this.data=e.data,"number"!=typeof this.data)?(e.meta.busy=!1,!1):void 0},write:function(){for(var t,a=0,n=this.radios.length;a<n;a++)t=this.radios[a],t.checked=a===this.data;e.meta.busy=!1}}:"checkbox"===n?{read:function(){return"view"===t?(e.data=e.target.checked,e.meta.busy=!1,!1):(this.data=e.data,"boolean"!=typeof this.data)?(e.meta.busy=!1,!1):void 0},write:function(){e.target.checked=this.data,e.meta.busy=!1}}:"file"===n?{read:function(){this.multiple=u.multiple(e.target),e.data=this.multiple?Array.prototype.slice.call(e.target.files):e.target.files[0],e.meta.busy=!1,this.data=e.data}}:{read:function(){return"view"===t?(e.data=e.target.value,e.meta.busy=!1,!1):(this.data=e.data,this.data===e.target.value)?(e.meta.busy=!1,!1):void 0},write:function(){e.target.value=void 0===this.data||null===this.data?"":this.data,e.meta.busy=!1}}},write:function(e){return{read:function(){if(this.data=e.data,!this.data===e.target.readOnly)return!1},write:function(){e.target.readOnly=!this.data}}}},f={get data(){return g},get binders(){return b},setup:function(e){return new Promise(function(t){for(var a in e=e||{},this.data.set("location",new Map),this.data.set("attribute",new Map),this.binders)this.binders[a]=this.binders[a].bind(this);if(e.binders)for(var n in e.binders)!1==n in this.binders&&(this.binders[n]=e.binders[n].bind(this));return t()}.bind(this))},get:function(e){if(!e)throw new Error("Oxe.binder.get - type argument required");var t=this.data.get(e);if(!t)return t;for(var a,n=1,r=arguments.length;n<r;n++)if(a=arguments[n],t=t.get(a),!t)return t;return t},create:function(t){if(void 0===t.name)throw new Error("Oxe.binder.create - missing name");if(void 0===t.value)throw new Error("Oxe.binder.create - missing value");if(void 0===t.target)throw new Error("Oxe.binder.create - missing target");if(void 0===t.container)throw new Error("Oxe.binder.create - missing container");if("{{"===t.value.slice(0,2)&&"}}"===t.value.slice(-2)&&(t.value=t.value.slice(2,-2)),-1!==t.value.indexOf("$")&&t.context&&t.context.variable&&t.context.path&&t.context.key){var a=new RegExp("\\$".concat(t.context.variable,"(,|\\s+|\\.|\\|)?(.*)?$"),"ig");t.value=t.value.replace(a,"".concat(t.context.path,".").concat(t.context.key,"$1$2"))}var n=t.container.scope,r=t.names||u.binderNames(t.name),i=t.pipes||u.binderPipes(t.value),d=t.values||u.binderValues(t.value),l=r[0],o=d.join("."),s=[n].concat(d),c=s.join("."),p=t.meta||{},h=t.context||{},m="on"===l||"submit"===l?t.container.methods:t.container.model;return{get location(){return c},get type(){return l},get path(){return o},get scope(){return n},get name(){return t.name},get value(){return t.value},get target(){return t.target},get container(){return t.container},get model(){return t.container.model},get methods(){return t.container.methods},get keys(){return s},get names(){return r},get pipes(){return i},get values(){return d},get meta(){return p},get context(){return h},get data(){var t=u.getByPath(m,d);return e(this,t)},set data(t){var a=e(this,t);return u.setByPath(m,d,a)}}},render:function(e,t){if("submit"!==e.type){var a=e.type in this.binders?e.type:"default",n=this.binders[a](e,t);m.batch(n)}},unbind:function(e){this.data.get("location").forEach(function(t){t.forEach(function(t){t.forEach(function(a,n){a.target===e&&t.splice(n,1)})})}),this.data.get("attribute").delete(e)},bind:function(e,t,a,n){if(a==="$".concat(n.variable,".$key")||a==="{{$".concat(n.variable,".$key}}"))return m.batch({write:function(){e.textContent=n.key}});if(a==="$".concat(n.variable,".$index")||a==="{{$".concat(n.variable,".$index}}"))return m.batch({write:function(){e.textContent=n.index}});var r=this.create({name:t,value:a,target:e,context:n,container:n.container,scope:n.container.scope});this.data.get("attribute").has(r.target)||this.data.get("attribute").set(r.target,new Map),this.data.get("location").has(r.scope)||this.data.get("location").set(r.scope,new Map),this.data.get("location").get(r.scope).has(r.path)||this.data.get("location").get(r.scope).set(r.path,[]),this.data.get("attribute").get(r.target).set(r.name,r),this.data.get("location").get(r.scope).get(r.path).push(r),this.render(r)},remove:function(e){this.unbind(e);for(var t=0;t<e.childNodes.length;t++)this.remove(e.childNodes[t])},add:function(e,t){if(e.nodeType===Node.TEXT_NODE){if(-1===e.textContent.indexOf("{{")||-1===e.textContent.indexOf("}}"))return;var a=e.textContent.indexOf("{{");-1!==a&&0!==a&&(e=e.splitText(a));var n=e.textContent.indexOf("}}"),r=e.textContent.length;if(-1!==n&&n!==r-2){var d=e.splitText(n+2);this.add(d,t)}this.bind(e,"o-text",e.textContent,t)}else if(e.nodeType===Node.ELEMENT_NODE){for(var o,s=!1,c=e.attributes,p=0,i=c.length;p<i;p++)(o=c[p],("o-html"===o.name||"o-scope"===o.name||0===o.name.indexOf("o-each"))&&(s=!0),"o-value"!==o.name&&"o-scope"!==o.name&&"o-reset"!==o.name&&"o-action"!==o.name&&"o-method"!==o.name&&"o-enctype"!==o.name&&0===o.name.indexOf("o-"))&&this.bind(e,o.name,o.value,t);if("o-value"in c&&this.bind(e,"o-value",c["o-value"].value,t),s)return;for(var l=0;l<e.childNodes.length;l++)this.add(e.childNodes[l],t)}}},y={headers:null,method:"get",mime:{xml:"text/xml; charset=utf-8",html:"text/html; charset=utf-8",text:"text/plain; charset=utf-8",json:"application/json; charset=utf-8",js:"application/javascript; charset=utf-8"},setup:function(e){return new Promise(function(t){return e=e||{},this.path=e.path,this.origin=e.origin,this.request=e.request,this.response=e.response,this.acceptType=e.acceptType,this.credentials=e.credentials,this.contentType=e.contentType,this.responseType=e.responseType,this.method=e.method||this.method,this.headers=e.headers||this.headers,t()}.bind(this))},serialize:function(e){return new Promise(function(t){var a="";for(var n in e)a=0<a.length?a+"&":a,a=a+encodeURIComponent(n)+"="+encodeURIComponent(e[n]);return t(a)})},fetch:function(e){return new Promise(function(t,a){function n(){function e(){return Promise.resolve(window.fetch(r.url,Object.assign({},r))).then(function(e){try{function n(){function e(){return t(r)}return this.response?(o=Object.assign({},r),Promise.resolve(this.response(o)).then(function(n){try{return(s=n,!1===s)?t(r):("object"===_typeof(s)&&Object.assign(r,s),e.call(this))}catch(e){return a(e)}}.bind(this),a)):e.call(this)}return l=e,r.code=l.status,r.message=l.statusText,r.responseType?Promise.resolve(l["buffer"===r.responseType?"arrayBuffer":r.responseType]()).then(function(e){try{return r.body=e,n.call(this)}catch(e){return a(e)}}.bind(this),a):(r.body=l.body,n.call(this))}catch(e){return a(e)}}.bind(this),a)}if(r.body){function t(){return e.call(this)}return"GET"===r.method?Promise.resolve(this.serialize(r.body)).then(function(e){try{return r.url=r.url+"?"+e,t.call(this)}catch(e){return a(e)}}.bind(this),a):("json"===r.contentType&&(r.body=JSON.stringify(r.body)),t.call(this))}return e.call(this)}var r,i,d,l,o,s;if(r=Object.assign({},e),r.path=r.path||this.path,r.origin=r.origin||this.origin,r.path&&"string"==typeof r.path&&"/"===r.path.charAt(0)&&(r.path=r.path.slice(1)),r.origin&&"string"==typeof r.origin&&"/"===r.origin.charAt(r.origin.length-1)&&(r.origin=r.origin.slice(0,-1)),r.path&&r.origin&&!r.url&&(r.url=r.origin+"/"+r.path),!r.method)return a(new Error("Oxe.fetcher - requires method option"));if(!r.url)return a(new Error("Oxe.fetcher - requires url or origin and path option"));if(!r.headers&&this.headers&&(r.headers=this.headers),"string"==typeof r.method&&(r.method=r.method.toUpperCase()||this.method),!r.acceptType&&this.acceptType&&(r.acceptType=this.acceptType),!r.contentType&&this.contentType&&(r.contentType=this.contentType),!r.responseType&&this.responseType&&(r.responseType=this.responseType),!r.credentials&&this.credentials&&(r.credentials=this.credentials),!r.mode&&this.mode&&(r.mode=this.mode),!r.cache&&this.cache&&(r.cahce=this.cache),!r.redirect&&this.redirect&&(r.redirect=this.redirect),!r.referrer&&this.referrer&&(r.referrer=this.referrer),!r.referrerPolicy&&this.referrerPolicy&&(r.referrerPolicy=this.referrerPolicy),!r.signal&&this.signal&&(r.signal=this.signal),!r.integrity&&this.integrity&&(r.integrity=this.integrity),!r.keepAlive&&this.keepAlive&&(r.keepAlive=this.keepAlive),r.contentType)switch(r.headers=r.headers||{},r.contentType){case"js":r.headers["Content-Type"]=this.mime.js;break;case"xml":r.headers["Content-Type"]=this.mime.xml;break;case"html":r.headers["Content-Type"]=this.mime.html;break;case"json":r.headers["Content-Type"]=this.mime.json;break;default:r.headers["Content-Type"]=r.contentType;}if(r.acceptType)switch(r.headers=r.headers||{},r.acceptType){case"js":r.headers.Accept=this.mime.js;break;case"xml":r.headers.Accept=this.mime.xml;break;case"html":r.headers.Accept=this.mime.html;break;case"json":r.headers.Accept=this.mime.json;break;default:r.headers.Accept=r.acceptType;}return"function"==typeof this.request?(i=Object.assign({},r),Promise.resolve(this.request(i)).then(function(e){try{return(d=e,!1===d)?t(r):("object"===_typeof(d)&&Object.assign(r,d),n.call(this))}catch(e){return a(e)}}.bind(this),a)):n.call(this)}.bind(this))},post:function(e){return new Promise(function(t){return e="string"==typeof e?{url:e}:e,e.method="post",t(this.fetch(e))}.bind(this))},get:function(e){return new Promise(function(t){return e="string"==typeof e?{url:e}:e,e.method="get",t(this.fetch(e))}.bind(this))},put:function(e){return new Promise(function(t){return e="string"==typeof e?{url:e}:e,e.method="put",t(this.fetch(e))}.bind(this))},head:function(e){return new Promise(function(t){return e="string"==typeof e?{url:e}:e,e.method="head",t(this.fetch(e))}.bind(this))},patch:function(e){return new Promise(function(t){return e="string"==typeof e?{url:e}:e,e.method="patch",t(this.fetch(e))}.bind(this))},delete:function(e){return new Promise(function(t){return e="string"==typeof e?{url:e}:e,e.method="delete",t(this.fetch(e))}.bind(this))},options:function(e){return new Promise(function(t){return e="string"==typeof e?{url:e}:e,e.method="options",t(this.fetch(e))}.bind(this))},connect:function(e){return new Promise(function(t){return e="string"==typeof e?{url:e}:e,e.method="connect",t(this.fetch(e))}.bind(this))}},v={},x={get data(){return v},get:function(e){return u.getByPath(this.data,e)},set:function(e,t){return u.setByPath(this.data,e,t)}},k={get base(){return h||(h=window.document.querySelector("base")),h?h.href:window.location.origin+(window.location.pathname?window.location.pathname:"/")},setup:function(e){return new Promise(function(t){return e=e||{},e.base&&(h=window.document.querySelector("base"),!h&&(h=window.document.createElement("base"),window.document.head.insertBefore(h,window.document.head.firstElementChild)),h.href=e.base),t()})},extension:function(e){var t=e.lastIndexOf(".");return 0<t?e.slice(t+1):""},clean:function(e){var t=window.location.hash,a=window.location.search,n=window.location.origin,r=window.location.protocol+"//";return e.slice(0,n.length)===n&&(e=e.slice(n.length)),e.slice(0,r.length)===r&&(e=e.slice(r.length)),e.slice(-t.length)===t&&(e=e.slice(0,-t.length)),e.slice(-a.length)===a&&(e=e.slice(0,-a.length)),e||"/"},normalize:function(e){var t=window.document.createElement("a");return e=this.clean(e),e=e.replace(/\/+/g,"/"),t.href=e,e=t.pathname,e=e?e:"/","/"!==e&&"/"===e.slice(-1)&&(e=e.slice(0,-1)),e},join:function(){if(!arguments.length)throw new Error("Oxe.path.join - argument required");for(var e=[],t=0,a=arguments.length;t<a;t++)e.push(arguments[t]);return this.normalize(e.join("/"))}},E={innerHandler:function(e,t,a){return"\\"===a[t-1]?void 0:"'"===e?"\\'":"\""===e?"\\\"":"\t"===e?"\\t":"\r"===e?"\\r":"\n"===e?"\\n":"w"===e?"\\w":"\b"===e?"\\b":void 0},updateString:function(e,t,a){return a.slice(0,t)+e+a.slice(t+1)},updateIndex:function(e,t){return t+e.length-1},template:function(e){var t=e.indexOf("`"),a=e.indexOf("`",t+1);if(-1===t||-1===a)return e;for(var n,r,i=0,d=0,l=e,o=!1,s=0;s<l.length;s++)r=l[s],"`"===r&&"\\"!==l[s-1]?o?(i++,n="'",o=!1,l=this.updateString(n,s,l),s=this.updateIndex(n,s)):(d++,n="'",o=!0,l=this.updateString(n,s,l),s=this.updateIndex(n,s)):o&&(n=this.innerHandler(r,s,l))&&(l=this.updateString(n,s,l),s=this.updateIndex(n,s));if(l=l.replace(/\${(.*?)}/g,"'+$1+'"),d==i)return l;throw new Error("import transformer missing backtick")},exp:/export\s+default\s*(var|let|const)?/,imps:/import(?:\s+(?:\*\s+as\s+)?\w+\s+from)?\s+(?:'|").*?(?:'|");?\n?/g,imp:/import(?:\s+(?:\*\s+as\s+)?(\w+)\s+from)?\s+(?:'|")(.*?)(?:'|");?\n?/,module:function(e,t){for(var a="return Promise.all([\n",n="]).then(function ($MODULES) {\n",r=t.slice(0,t.lastIndexOf("/")+1),d=e.match(this.imps)||[],o=0,i=d.length;o<i;o++){var l=d[o].match(this.imp),s=l[0],c=l[1],p=l[2];p="/"===p.slice(0,1)?k.normalize(p):k.normalize(r+"/"+p),a=a+"\t$LOADER.load(\""+p+"\"),\n",n=n+"var "+c+" = $MODULES["+o+"].default;\n",e=e.replace(s,"")}return this.exp.test(e)&&(e=e.replace(this.exp,"var $DEFAULT = "),e+="\n\nreturn { default: $DEFAULT };\n"),e="\"use strict\";\n"+a+n+e+"}).catch(function (error) { return error; });",e}},O={data:{},type:"esm",setup:function(e){return new Promise(function(t){var a=this;return e=e||{},this.type=e.type||this.type,e.loads?t(Promise.all(e.loads.map(function(e){return a.load(e)}))):t()}.bind(this))},fetch:function(e,t){return new Promise(function(a,n){var r,i,d,l;return Promise.resolve(window.fetch(e)).then(function(o){try{return r=o,404==r.status?n(new Error("Oxe.loader.load - not found "+e)):200>r.status||300<r.status&&304!=r.status?n(new Error(r.statusText)):Promise.resolve(r.text()).then(function(r){try{return i=r,("es"===t||"est"===t)&&(i=E.template(i)),("es"===t||"esm"===t)&&(i=E.module(i,e)),d=new Function("window","document","$LOADER",i),Promise.resolve(d(window,window.document,this)).then(function(t){try{return l=t,l instanceof Error?n(new l.constructor("".concat(l.message," - ").concat(e),l.fileName,l.lineNumber)):a(this.data[e]=l)}catch(e){return n(e)}}.bind(this),n)}catch(e){return n(e)}}.bind(this),n)}catch(e){return n(e)}}.bind(this),n)}.bind(this))},load:function(){var e=arguments;return new Promise(function(t,a){var n,r;return("object"===_typeof(e[0])?(n=e[0].url,r=e[0].type):(n=e[0],r=e[1]||this.type),!n)?a(new Error("Oxe.loader.load - url argument required")):(n=k.normalize(n),!1==n in this.data&&(this.data[n]=this.fetch(n,r)),t(this.data[n]))}.bind(this))}},w={splice:function(){var e=this,t=arguments[0],a=arguments[1],n=2<arguments.length?arguments.length-2:0;if("number"!=typeof t||"number"!=typeof a)return[];0>t?(t=e.length+t,t=0<t?t:0):t=t<e.length?t:e.length,0>a?a=0:a>e.length-t&&(a=e.length-t);var r=e.$meta.length,i=2,d=arguments.length-i,l=e.slice(t,a),o=r-1-t,s=[],c=e.length+n-a;if(e.length!==c&&s.push(e.$meta.listener.bind(null,e,e.$meta.path.slice(0,-1),"length")),0<o)for(var p,h,u=t;o--;)h=u++,p=d&&i<d?arguments[i++]:e.$meta[u],e.$meta[h]=w.create(p,e.$meta.listener,e.$meta.path+h),s.push(e.$meta.listener.bind(null,e.$meta[h],e.$meta.path+h,h));if(0<n)for(;n--;){var m=e.length;!1==m in this&&Object.defineProperty(this,m,w.descriptor(m)),e.$meta[m]=w.create(arguments[i++],e.$meta.listener,e.$meta.path+m),s.push(e.$meta.listener.bind(null,e.$meta[m],e.$meta.path+m,m))}if(0<a)for(;a--;){e.$meta.length--,e.length--;var g=e.length;s.push(e.$meta.listener.bind(null,void 0,e.$meta.path+g,g))}return Promise.resolve().then(function(){s.reduce(function(e,t){return e.then(t)},Promise.resolve())}).catch(console.error),l},arrayProperties:function(){var e=this;return{push:{value:function(){if(!arguments.length)return this.length;for(var t=0,a=arguments.length;t<a;t++)e.splice.call(this,this.length,0,arguments[t]);return this.length}},unshift:{value:function(){if(!arguments.length)return this.length;for(var t=0,a=arguments.length;t<a;t++)e.splice.call(this,0,0,arguments[t]);return this.length}},pop:{value:function(){if(this.length){var t=e.splice.call(this,this.length-1,1);return t[0]}}},shift:{value:function(){if(this.length){var t=e.splice.call(this,0,1);return t[0]}}},splice:{value:e.splice}}},objectProperties:function(){var e=this;return{$get:{value:function(e){return this.$meta[e]}},$set:{value:function(t,a){a!==this.$meta[t]&&(!1==t in this&&Object.defineProperty(this,t,e.descriptor(t)),this.$meta[t]=e.create(a,this.$meta.listener,this.$meta.path+t),this.$meta.listener(this.$meta[t],this.$meta.path+t,t,this))}},$remove:{value:function(t){if(t in this){if(this.constructor===Array)return e.splice.call(this,t,1);var a=this[t];return delete this.$meta[t],delete this[t],this.$meta.listener(void 0,this.$meta.path+t,t),a}}}}},descriptor:function(e){var t=this;return{enumerable:!0,configurable:!0,get:function(){return this.$meta[e]},set:function(a){a!==this.$meta[e]&&(this.$meta[e]=t.create(a,this.$meta.listener,this.$meta.path+e),this.$meta.listener(this.$meta[e],this.$meta.path+e,e,this))}}},create:function(e,t,a){if(!e||e.constructor!==Object&&e.constructor!==Array)return e;a=a?a+".":"";var n=e.constructor,r=e.constructor(),i={};if(i.$meta={value:e.constructor()},i.$meta.value.path=a,i.$meta.value.listener=t,n===Array)for(var d=0,l=e.length;d<l;d++)i.$meta.value[d]=this.create(e[d],t,a+d),i[d]=this.descriptor(d);if(n===Object)for(var o in e)i.$meta.value[o]=this.create(e[o],t,a+o),i[o]=this.descriptor(o);return Object.defineProperties(r,i),Object.defineProperties(r,this.objectProperties(e,t,a)),n===Array&&Object.defineProperties(r,this.arrayProperties(e,t,a)),r}},$={GET:2,SET:3,REMOVE:4,data:null,tasks:[],target:{},setup:function(e){return new Promise(function(t){return e=e||{},this.target=e.target||this.target,this.data=w.create(this.target,this.listener.bind(this)),t()}.bind(this))},traverse:function(e,t,a){var n;"string"==typeof t&&(t=t.split("."));for(var r=this.data,d=t[t.length-1],o=0,i=t.length-1;o<i;o++){if(!(t[o]in r)){if(e===this.GET||e===this.REMOVE)return;e===this.SET&&r.$set(t[o],isNaN(t[o+1])?{}:[])}r=r[t[o]]}return e===this.SET?n=r.$set(d,a):e===this.GET?n=r[d]:e===this.REMOVE&&(n=r[d],r.$remove(d)),n},get:function(e){return this.traverse(this.GET,e)},remove:function(e){return this.traverse(this.REMOVE,e)},set:function(e,t){return this.traverse(this.SET,e,t)},listener:function(e,t,a){var n=t.split("."),r=n.slice(1).join("."),i=n.slice(0,1).join("."),d=f.get("location",i);d&&d.forEach(function(e,t){(""===r||t===r||"length"!==a&&0===t.indexOf(r+"."))&&e.forEach(function(e){f.render(e)})})}},T=document.createElement("style"),C=T.sheet;T.setAttribute("title","oxe"),T.setAttribute("type","text/css");var j={get style(){return T},get sheet(){return C},add:function(e){this.sheet.insertRule(e)},append:function(e){this.style.appendChild(document.createTextNode(e))},setup:function(e){return new Promise(function(t){return e=e||{},e.style&&this.append(e.style),document.head.appendChild(this.style),t()}.bind(this))}},A={setup:function(){return new Promise(function(e){return void 0===window.Reflect&&(window.Reflect=window.Reflect||{},window.Reflect.construct=function(e,t,a){var n=void 0===a?e:a,r=n.prototype||Object.prototype,i=Object.create(r);return Function.prototype.apply.call(e,i,t)||i}),e()})},define:function(e,t){t=t||function(){};for(var a=function(){var e=window.Reflect.construct(HTMLElement,[],this.constructor);return t.call(e),e},n=Object.getOwnPropertyNames(t.prototype),r={},d=0;d<n.length;d++)r[n[d]]=Object.getOwnPropertyDescriptor(t.prototype,n[d]);a.prototype=Object.create(HTMLElement.prototype),Object.defineProperties(a.prototype,r),Object.defineProperty(a.prototype,"constructor",{enumerable:!1,writable:!0,value:a}),window.customElements.define(e,a)}},P={data:{},setup:function(e){return new Promise(function(t){var a=this;return e=e||{},e.components?t(Promise.all(e.components.map(function(e){return"string"==typeof e?O.load(e).then(function(e){return a.define(e.default)}):a.define(e)}))):t()}.bind(this))},style:function(e,t){if(e=e.replace(/\n|\r|\t/g,""),e=e.replace(/:host/g,t),!window.CSS||!window.CSS.supports||!window.CSS.supports("(--t: black)"))for(var a=e.match(/--\w+(?:-+\w+)*:\s*.*?;/g)||[],n=0,r=a.length;n<r;n++){var i=a[n],d=i.match(/(--\w+(?:-+\w+)*):\s*(.*?);/),l=new RegExp("var\\("+d[1]+"\\)","g");e=e.replace(d[0],""),e=e.replace(l,d[2])}return e},slot:function(e,t){for(var a=t.querySelectorAll("slot[name]"),n=t.querySelector("slot:not([name])"),r=0,i=a.length;r<i;r++){var d=a[r],l=d.getAttribute("name"),o=e.querySelector("[slot=\""+l+"\"]");o?d.parentNode.replaceChild(o,d):d.parentNode.removeChild(d)}if(n){if(e.children.length)for(;e.firstChild;)n.parentNode.insertBefore(e.firstChild,n);n.parentNode.removeChild(n)}},fragment:function(e,t,a){for(var n=document.createDocumentFragment(),r=t.cloneNode(!0),i=r.firstElementChild;i;)a||f.add(i,{container:e,scope:e.scope}),n.appendChild(i),i=r.firstElementChild;return n},render:function(e,t,a,n){if(t){var r,i=this.fragment(e,t);if(n&&"attachShadow"in document.body?r=e.attachShadow({mode:"open"}):n&&"createShadowRoot"in document.body?r=e.createShadowRoot():(i&&this.slot(e,i),r=e),i&&r.appendChild(i),a)for(var d=r.firstElementChild;d;)f.add(d,{container:e,scope:e.scope}),d=d.nextElementSibling}},define:function(e){var t=this;if("object"!==_typeof(e))return console.warn("Oxe.component.define - invalid argument type");if(e.constructor===Array){for(var a=0,n=e.length;a<n;a++)t.define(e[a]);return}if(!e.name)return console.warn("Oxe.component.define - requires name");if(e.name=e.name.toLowerCase(),e.name in t.data)return console.log(e.name),console.warn("Oxe.component.define - component defined");if(t.data[e.name]=e,e.count=0,e.model=e.model||{},e.adopt=e.adopt||!1,e.methods=e.methods||{},e.shadow=e.shadow||!1,e.attributes=e.attributes||[],e.properties=e.properties||{},e.style&&(e.style=this.style(e.style,e.name),j.append(e.style)),e.template&&"string"==typeof e.template){var r=document.createElement("div");r.innerHTML=e.template,e.template=r}var i=function(){this._created=!1,this._scope=e.name+"-"+e.count++;var t=u.clone(e.properties),a=u.clone(e.methods),n=u.clone(e.model);Object.defineProperties(this,t),x.set(this.scope,a),$.set(this.scope,n)};Object.defineProperties(i.prototype,{created:{get:function(){return this._created}},scope:{get:function(){return this._scope}},methods:{get:function(){return x.get(this.scope)}},model:{get:function(){return $.get(this.scope)},set:function(e){return $.set(this.scope,e&&"object"===_typeof(e)?e:{})}},observedAttributes:{value:e.attributes},attributeChangedCallback:{value:function(){e.attributed&&e.attributed.apply(this,arguments)}},adoptedCallback:{value:function(){e.adopted&&e.adopted.apply(this,arguments)}},disconnectedCallback:{value:function(){e.detached&&e.detached.call(this)}},connectedCallback:{value:function(){var a=this;a.created?e.attached&&e.attached.call(a):(a._created=!0,t.render(a,e.template,e.adopt,e.shadow),Promise.resolve().then(function(){if(e.created)return e.created.call(a)}).then(function(){if(e.attached)return e.attached.call(a)}))}}}),A.define(e.name,i)}},q={},S={get events(){return q},on:function(e,t){e in this.events||(this.events[e]=[]),this.events[e].push(t)},off:function(e,t){if(e in this.events){var a=this.events[e].indexOf(t);-1!==a&&this.events[e].splice(a,1)}},emit:function(e){if(e in this.events){var t=this.events[e],a=Array.prototype.slice.call(arguments,2);Promise.all(t.map(function(e){return e.apply(this,a)})).catch(console.error)}}},L=Object.create(S),N={on:L.on.bind(L),off:L.off.bind(L),emit:L.emit.bind(L),data:[],ran:!1,location:{},mode:"push",target:null,contain:!1,folder:"./routes",setup:function(e){return new Promise(function(t,a){return e=e||{},this.base=void 0===e.base?this.base:e.base,this.mode=void 0===e.mode?this.mode:e.mode,this.after=void 0===e.after?this.after:e.after,this.folder=void 0===e.folder?this.folder:e.folder,this.before=void 0===e.before?this.before:e.before,this.change=void 0===e.change?this.change:e.change,this.target=void 0===e.target?this.target:e.target,this.contain=void 0===e.contain?this.contain:e.contain,this.external=void 0===e.external?this.external:e.external,this.target&&"string"!=typeof this.target||(this.target=document.body.querySelector(this.target||"o-router")),"href"!==this.mode&&(window.addEventListener("popstate",this.state.bind(this),!0),window.document.addEventListener("click",this.click.bind(this),!0)),A.define("o-router"),Promise.resolve(this.add(e.routes)).then(function(){try{return Promise.resolve(this.route(window.location.href,{mode:"replace"})).then(function(){try{return t()}catch(e){return a(e)}},a)}catch(e){return a(e)}}.bind(this),a)}.bind(this))},compareParts:function(e,t,a){var n=[],r=e.split(a),d=t.split(a);1<d.length&&""===d[d.length-1]&&d.pop(),1<r.length&&""===r[r.length-1]&&r.pop();for(var o=0,i=r.length;o<i;o++)if("("===r[o].slice(0,1)&&")"===r[o].slice(-1)){if("(~)"===r[o])return!0;-1===r[o].indexOf("~")?n.push(d[o]):d[o]&&n.push(d[o])}else{if(r[o]!==d[o])return!1;n.push(r[o])}return!(n.join(a)!==d.join(a))},compare:function(e,t){var a=k.normalize(k.base);return t=k.normalize(t),e=k.normalize(e),t.slice(0,a.length)!==a&&(t=k.join(a,t)),e.slice(0,a.length)!==a&&(e=k.join(a,e)),!!this.compareParts(e,t,"/")||!!this.compareParts(e,t,"-")},toParameterObject:function(e,t){var a={};if(!e||!t||"/"===e||"/"===t)return a;for(var n,r=t.split(/\/|-/),d=e.split(/\/|-/),o=0,i=d.length;o<i;o++)if(n=d[o],"("===n.slice(0,1)&&")"===n.slice(-1)){var l=n.slice(1,n.length-1).replace("~","");a[l]=r[o]}return a},toQueryString:function(e){var t="?";for(var a in e){var n=e[a];t+=a+"="+n+"&"}return"&"===t.slice(-1)&&(t=t.slice(0,-1)),t},toQueryObject:function(e){var t={};0===e.indexOf("?")&&(e=e.slice(1));for(var a,n=e.split("&"),r=0,i=n.length;r<i;r++)a=n[r].split("="),a[0]&&a[1]&&(t[a[0]]=a[1]);return t},toLocationObject:function(e){var t={},a=document.createElement("a");return a.href=e,t.href=a.href,t.host=a.host,t.port=a.port,t.hash=a.hash,t.search=a.search,t.protocol=a.protocol,t.hostname=a.hostname,t.pathname="/"===a.pathname[0]?a.pathname:"/"+a.pathname,t.path=t.pathname+t.search+t.hash,t},scroll:function(e,t){window.scroll(e,t)},back:function(){window.history.back()},forward:function(){window.history.forward()},redirect:function(e){window.location.href=e},add:function(e){return new Promise(function(t,a){function n(){return t()}var s,c,p,i;if(!e)return t();function r(){return n.call(this)}if(e.constructor===String)return s=e,".js"===s.slice(-3)&&(s=s.slice(0,-3)),c=s,"index"===s.slice(-5)&&(s=s.slice(0,-5)),"index/"===s.slice(-6)&&(s=s.slice(0,-6)),"./"===s.slice(0,2)&&(s=s.slice(2)),"/"!==s.slice(0,1)&&(s="/"+s),c=c.replace(/\/?\((\w+)?\~\)\/?/ig,"")+".js",c=k.join(this.folder,c),this.data.push({path:s,load:c}),r.call(this);function d(){return r.call(this)}if(e.constructor===Object)return e.path?e.name||e.load||e.component?(this.data.push(e),d.call(this)):a(new Error("Oxe.router.add -  route requires name, load, or component property")):a(new Error("Oxe.router.add - route path required"));function o(){return d.call(this)}if(e.constructor===Array){function t(){return p++,n}function n(){return p<i?Promise.resolve(this.add(e[p])).then(function(){try{return t}catch(e){return a(e)}},a):[1]}function r(){return o.call(this)}p=0,i=e.length;var l;return(l=function(e){for(;e;){if(e.then)return void e.then(l,a);try{if(e.pop){if(e.length)return e.pop()?r.call(this):e;e=t}else e=e.call(this)}catch(e){return a(e)}}}.bind(this))(n)}return o.call(this)}.bind(this))},load:function(e){return new Promise(function(t,a){function n(){function n(){return t(e)}return"string"==typeof e.component?(e.load=e.component,Promise.resolve(O.load(e.load)).then(function(t){try{return i=t,e.component=i.default,n.call(this)}catch(e){return a(e)}}.bind(this),a)):n.call(this)}var r,i;return e.load?Promise.resolve(O.load(e.load)).then(function(t){try{return r=t,e=Object.assign({},r.default,e),n.call(this)}catch(e){return a(e)}}.bind(this),a):n.call(this)})},remove:function(e){return new Promise(function(t){for(var a=0,n=this.data.length;a<n;a++)this.data[a].path===e&&this.data.splice(a,1);return t()}.bind(this))},get:function(e){return new Promise(function(t,a){function n(){return o++,r}function r(){return o<i?this.data[o].path===e?Promise.resolve(this.load(this.data[o])).then(function(e){try{return this.data[o]=e,t(this.data[o])}catch(e){return a(e)}}.bind(this),a):n:[1]}function d(){return t()}var o,i;o=0,i=this.data.length;var l;return(l=function(e){for(;e;){if(e.then)return void e.then(l,a);try{if(e.pop){if(e.length)return e.pop()?d.call(this):e;e=n}else e=e.call(this)}catch(e){return a(e)}}}.bind(this))(r)}.bind(this))},filter:function(e){return new Promise(function(t,a){function n(){return s++,r}function r(){if(s<i){function t(){return n}return this.compare(this.data[s].path,e)?Promise.resolve(this.load(this.data[s])).then(function(e){try{return this.data[s]=e,o.push(this.data[s]),t.call(this)}catch(e){return a(e)}}.bind(this),a):t.call(this)}return[1]}function d(){return t(o)}var o,s,i;o=[],s=0,i=this.data.length;var l;return(l=function(e){for(;e;){if(e.then)return void e.then(l,a);try{if(e.pop){if(e.length)return e.pop()?d.call(this):e;e=n}else e=e.call(this)}catch(e){return a(e)}}}.bind(this))(r)}.bind(this))},find:function(e){return new Promise(function(t,a){function n(){return o++,r}function r(){return o<i?this.compare(this.data[o].path,e)?Promise.resolve(this.load(this.data[o])).then(function(e){try{return this.data[o]=e,t(this.data[o])}catch(e){return a(e)}}.bind(this),a):n:[1]}function d(){return t()}var o,i;o=0,i=this.data.length;var l;return(l=function(e){for(;e;){if(e.then)return void e.then(l,a);try{if(e.pop){if(e.length)return e.pop()?d.call(this):e;e=n}else e=e.call(this)}catch(e){return a(e)}}}.bind(this))(r)}.bind(this))},render:function(e){return new Promise(function(t,a){if(!e)return a(new Error("Oxe.render - route argument required. Missing object option."));e.title&&(document.title=e.title);var n=[];if(e.keywords&&n.push({name:"meta",query:"[name=\"keywords\"]",attributes:[{name:"name",value:"keywords"},{name:"content",value:e.keywords}]}),e.description&&n.push({name:"meta",query:"[name=\"description\"]",attributes:[{name:"name",value:"description"},{name:"content",value:e.description}]}),e.canonical&&n.push({name:"link",query:"[rel=\"canonical\"]",attributes:[{name:"rel",value:"canonical"},{name:"href",value:e.canonical}]}),n.length&&Promise.all(n.map(function(e){return Promise.resolve().then(function(){return e.position="afterbegin",e.scope=document.head,u.ensureElement(e)})})),!e.target)if(!e.component)P.define(e),e.target=window.document.createElement(e.name);else if(e.component.constructor===String)e.target=window.document.createElement(e.component);else if(e.component.constructor===Object)P.define(e.component),e.target=window.document.createElement(e.component.name);else return a(new Error("Oxe.router.render - route requires name, load, or component property"));if(this.target){for(;this.target.firstChild;)this.target.removeChild(this.target.firstChild);this.target.appendChild(e.target)}return this.scroll(0,0),t()}.bind(this))},route:function(e,t){return new Promise(function(a,n){var r,i,d;return t=t||{},t.query&&(e+=this.toQueryString(t.query)),r=t.mode||this.mode,i=this.toLocationObject(e),Promise.resolve(this.find(i.pathname)).then(function(e){try{function t(){return(this.emit("route:before",i),"href"===r)?a(window.location.assign(i.path)):(window.history[r+"State"]({path:i.path},"",i.path),this.location=i,Promise.resolve(this.render(i.route)).then(function(){try{function e(){return this.emit("route:after",i),a()}return"function"==typeof this.after?Promise.resolve(this.after(i)).then(function(){try{return e.call(this)}catch(e){return n(e)}}.bind(this),n):e.call(this)}catch(e){return n(e)}}.bind(this),n))}return(d=e,!d)?n(new Error("Oxe.router.route - missing route ".concat(i.pathname))):(i.route=d,i.title=i.route.title,i.query=this.toQueryObject(i.search),i.parameters=this.toParameterObject(i.route.path,i.pathname),i.route&&i.route.handler?Promise.resolve(i.route.handler(i)).then(a,n):i.route&&i.route.redirect?Promise.resolve(this.redirect(i.route.redirect)).then(a,n):"function"==typeof this.before?Promise.resolve(this.before(i)).then(function(){try{return t.call(this)}catch(e){return n(e)}}.bind(this),n):t.call(this))}catch(e){return n(e)}}.bind(this),n)}.bind(this))},state:function(e){return new Promise(function(t){var a=e&&e.state?e.state.path:window.location.href;return this.route(a,{mode:"replace"}),t()}.bind(this))},click:function(e){return new Promise(function(t){if(e.target.type||0!==e.button||e.defaultPrevented||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return t();var a=e.path?e.path[0]:e.target,n=a.parentElement;if(this.contain){for(;n&&"O-ROUTER"!==n.nodeName;)n=n.parentElement;if("O-ROUTER"!==n.nodeName)return t()}for(;a&&"A"!==a.nodeName;)a=a.parentElement;return a&&"A"===a.nodeName?a.hasAttribute("download")||a.hasAttribute("external")||a.hasAttribute("o-external")||0===a.href.indexOf("tel:")||0===a.href.indexOf("ftp:")||0===a.href.indexOf("file:")||0===a.href.indexOf("mailto:")||0!==a.href.indexOf(window.location.origin)||""!==a.hash&&a.origin===window.location.origin&&a.pathname===window.location.pathname?t():this.external&&(this.external.constructor===RegExp&&this.external.test(a.href)||this.external.constructor===Function&&this.external(a.href)||this.external.constructor===String&&this.external===a.href)?t():(e.preventDefault(),this.location.href!==a.href&&this.route(a.href),t()):t()}.bind(this))}};document.head.insertAdjacentHTML("afterbegin","<style>:not(:defined){visibility:hidden;}o-router,o-router>:first-child{display:block;}</style>");var R=document.querySelector("script[o-setup]");R&&Promise.resolve().then(function(){var e=R.getAttribute("o-setup");if(!e)throw new Error("Oxe - attribute o-setup requires arguments");var t=e.split(/\s+|\s*,+\s*/);return O.type=t[1]||"esm",O.load(t[0])});var _=!1,D=Object.freeze({global:{},component:P,batcher:m,definer:A,fetcher:y,methods:x,utility:u,binder:f,loader:O,router:N,model:$,style:j,path:k,setup:function(e){var t=this;if(!_)return _=!0,e=e||{},e.listener=e.listener||{},document.addEventListener("input",p.bind(null,e,s),!0),document.addEventListener("reset",p.bind(null,e,c),!0),document.addEventListener("change",p.bind(null,e,l),!0),document.addEventListener("submit",p.bind(null,e,o),!0),Promise.all([t.path.setup(e.path),t.style.setup(e.style),t.model.setup(e.model),t.binder.setup(e.binder),t.loader.setup(e.loader),t.definer.setup(e.definer),t.fetcher.setup(e.fetcher)]).then(function(){if(e.listener.before)return e.listener.before()}).then(function(){if(e.component)return t.component.setup(e.component)}).then(function(){if(e.router)return t.router.setup(e.router)}).then(function(){if(e.listener.after)return e.listener.after()})}});return D});
