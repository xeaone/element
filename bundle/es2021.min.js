/**
* @version 10.0.1
*
* @license
* Copyright (C) Alexander Elias
* This Source Code Form is subject to the terms of the Mozilla Public
* License, v. 2.0. If a copy of the MPL was not distributed with this
* file, You can obtain one at http://mozilla.org/MPL/2.0/.
*
* @module
*/

var ye=globalThis.XGLOBAL??(globalThis.XGLOBAL=Object.freeze({Bound:new WeakMap,BindersCache:new Set,TemplatesCache:new WeakMap,ContainersCache:new WeakMap,MarkSymbol:Symbol("mark"),ViewSymbol:Symbol("view"),TemplateSymbol:Symbol("template"),VariablesSymbol:Symbol("variables")})),{BindersCache:N,TemplatesCache:_,ContainersCache:C,MarkSymbol:h,ViewSymbol:p,TemplateSymbol:j,VariablesSymbol:F}=ye;var{SHOW_TEXT:U,SHOW_ELEMENT:G}=NodeFilter,{TEXT_NODE:Z,COMMENT_NODE:Re,ELEMENT_NODE:J,ATTRIBUTE_NODE:Me,DOCUMENT_FRAGMENT_NODE:Le}=Node,de=new RegExp(["^[.@$]?(",["src","href","data","action","srcdoc","xlink:href","cite","formaction","ping","poster","background","classid","codebase","longdesc","profile","usemap","icon","manifest","archive"].join("|"),")"].join(""),"i"),he=new RegExp(["^[.@$]?(",["hidden","allowfullscreen","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"].join("|"),")"].join(""),"i");var Te=/^[.@$]?ontimeout$/i,xe=/^[.@$]?ononce$/i,Ne=/^[.@$]?value$/i,Y=/^[.@$]?on/i;var ve=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i,w=function(e){return e&&typeof e=="string"?de.test(e):!1},k=function(e){return e&&typeof e=="string"?he.test(e):!1},K=function(e){return e&&typeof e!="string"&&typeof e[Symbol.iterator]=="function"};var Q=function(e){return e&&typeof e=="string"?xe.test(e):!1},ee=function(e){return e&&typeof e=="string"?Te.test(e):!1},O=function(e){return e&&typeof e=="string"?Ne.test(e):!1},d=function(e){return e&&typeof e=="string"?Y.test(e):!1};var q=function(e,t){return e&&t&&typeof e=="string"&&typeof t=="string"?e.toLowerCase()===t.toLowerCase():!1},te=function(e,t){return e&&typeof e=="string"?e.indexOf(t)!==-1:!1},A=function(e){return e&&typeof e=="string"?e.replace(Y,""):""},oe=function(e){return e.nodeType===Node.ATTRIBUTE_NODE?e.parentNode?.isConnected??!1:e.isConnected},ne=function(){return`x-${`${Math.floor(Math.random()*Date.now())}`.slice(0,10)}-x`},B=function(e){return e===""||typeof e!="string"?!1:!ve.test(e)},P=function(e,t){let n=t.previousSibling;for(;n&&n!==e;)n.parentNode?.removeChild(n),n=t.previousSibling},z=function(e){e.parentNode.removeChild(e)},T=function(e,t){e instanceof Node||(e=t.ownerDocument.createTextNode(`${e}`)),t.parentNode.insertBefore(e,t)},re=function(e,t){e instanceof Node||(e=t.ownerDocument.createTextNode(`${e}`)),t.parentNode.insertBefore(e,t.nextSibling)},se=function(e,t){t.parentNode.replaceChild(e,t)},X=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);for(let n of t)e.appendChild(typeof n=="string"?e.ownerDocument.createTextNode(n):n)};var y=function(e){return{data:e instanceof Node?new WeakRef(e):e,get:function(){return this.data instanceof WeakRef?this.data.deref():this.data},set:function(t){return t instanceof Node?(this.data=new WeakRef(t),t):(this.data=t,t)}}};var ie=function(e,t,n,o){n=n?.toLowerCase()??"",o=o?.toLowerCase()??"",n!==o&&(d(n)?typeof t.value=="function"&&e.removeEventListener(A(n),t.value,!0):O(n)?(e.removeAttribute(n),Reflect.set(e,n,null)):k(n)?(e.removeAttribute(n),Reflect.set(e,n,!1)):(w(n)||n)&&(e.removeAttribute(n),Reflect.deleteProperty(e,n)),!d(o)&&(k(o)?(t.value="",e.setAttribute(o,""),Reflect.set(e,o,!0)):o&&(e.setAttribute(o,""),Reflect.set(e,o,null)),t.name=o||""))};var D=function(e){switch(`${e}`){case"NaN":return"";case"null":return"";case"undefined":return""}switch(typeof e){case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"symbol":return String(e);case"object":return JSON.stringify(e)}throw new Error("XElement - display type not handled")};var R,M,ge=async function(){console.log("next"),await M,await new Promise(e=>{queueMicrotask(async()=>{R=void 0,await V(),e(void 0)})})},V=async function(){console.log("update"),M?R?await R:(R=ge(),await R):(M=new Promise(e=>{queueMicrotask(async()=>{let t=N.values();for(let n of t)try{await L(n)}catch(o){console.error(o)}M=void 0,e()})}),await M)},Se=function(){let e=N.values();for(let t of e)try{L(t)}catch(n){console.error(n)}};var I=function(e){return{get target(){return e?.node},query(t){return e?.node?.getRootNode()?.querySelector(t)}}};var le=function(e,t,n,o){if(n!==o){if(!t.name){console.warn("attribute binder name required");return}if(O(t.name))if(e.nodeName==="SELECT"){let s=e.options,l=Array.isArray(o);for(let c of s)c.selected=l?o.includes(c.value):`${o}`===c.value}else t.value=D(o),e.setAttribute(t.name,t.value),Reflect.set(e,t.name,t.value);else if(w(t.name)){if(t.value=encodeURI(o),B(t.value)){e.removeAttribute(t.name),console.warn(`XElement - attribute name "${t.name}" and value "${t.value}" not allowed`);return}e.setAttribute(t.name,t.value),Reflect.set(e,t.name,t.value)}else if(k(t.name)){let s=!!o;s?e.setAttribute(t.name,""):e.removeAttribute(t.name),Reflect.set(e,t.name,s)}else if(d(t.name)){e.hasAttribute(t.name)&&e.removeAttribute(t.name),typeof t.value=="function"&&e.removeEventListener(A(t.name),t.value,n?.[1]??!0);let s=typeof o=="function"?o:o?.[0];if(typeof s!="function")return console.warn(`XElement - attribute name "${t.name}" expected a function`);let l;t.value=function(){if(e.nodeName==="INPUT"&&e.type==="radio"){let r=e.ownerDocument.querySelectorAll(`input[name="${e.name}"]`);for(let i of r)i.checked&&(l=i.checked)}let c=s.call(this,I(t));return c!==l&&(l=c,V()),c},Q(t.name)?t.value():ee(t.name)?setTimeout(t.value,o?.[1]):e.addEventListener(A(t.name),t.value,o?.[1]??!0)}else t.value=o,e.setAttribute(t.name,t.value),Reflect.set(e,t.name,t.value)}};var ce=function(e){return e?.[p]?e():e instanceof Node?e:D(e)},ae=function(e,t,n,o){if(o==null)e.textContent!==""&&(e.textContent="");else if(o?.[p])t.start||(t.start=document.createTextNode(""),T(t.start,e)),t.end||(e.textContent="",t.end=e),P(t.start,t.end),T(o(),t.end);else if(o instanceof DocumentFragment)t.start||(t.start=document.createTextNode(""),T(t.start,e)),t.end||(e.textContent="",t.end=e),P(t.start,t.end),T(o,t.end);else if(K(o)){t.length===void 0&&(t.length=0),t.results||(t.results=[]),t.markers||(t.markers=[]),t.start||(t.start=document.createTextNode(""),T(t.start,e)),t.end||(e.textContent="",t.end=e);let s=t.length,l=o.length,c=Math.min(s,l);for(let r=0;r<c;r++){if(o[r]===t.results[r]||o[r]?.[p]&&t.results[r]?.[p]&&o[r]?.[h]===t.results[r]?.[h])continue;let i=t.markers[r],a=t.markers[r+1]??t.end;for(;a.previousSibling&&a.previousSibling!==i;)z(a.previousSibling);let u=ce(o[r]);re(u,i),console.log(t.results[r],o[r],u,i),t.results[r]=o[r]}if(s<l)for(;t.length!==o.length;){let r=document.createTextNode(""),i=ce(o[t.length]);t.markers.push(r),t.results.push(o[t.length]),T(r,t.end),T(i,t.end),t.length++}else if(s>l){let r=t.markers[o.length-1],i=t.end;for(;i.previousSibling&&i.previousSibling!==r;)z(i.previousSibling);t.length=o.length,t.results.length=o.length,t.markers.length=o.length}}else if(o instanceof Node)se(o,e);else{if(e.textContent===`${o}`)return;e.textContent=`${o}`}};var we=function(e,t,n,o){console.warn("element action not implemented")},L=function(e){let t=e.node;if(!t||!oe(t)&&e.isInitialized)return;let n=e.variable,o=typeof n=="function",s=o&&n[p],l=e.type===3&&d(e.name),c=!s&&!l&&o;(l||s||!o)&&e.remove();let r=c?n(I(e)):s?n():n,i=e.source;if(!("source"in e&&(i===r||i?.[p]&&r?.[p]&&i?.[h]===r?.[h]))){if(e.type===1)we(t,e,i,r);else if(e.type===2)ie(t,e,i,r);else if(e.type===3)le(t,e,i,r);else if(e.type===4)ae(t,e,i,r);else throw new Error("instruction type not valid");e.source=r,e.isInitialized=!0}};var v=function(e,t,n,o,s,l){let c={type:e,isInitialized:!1,get variable(){return n[t]},set variable(r){n[t]=r},get node(){let r=o.get();if(r)return r;N.delete(this)},get name(){return s.get()},set name(r){s.set(r)},get value(){return l.get()},set value(r){l.set(r)},remove(){N.delete(this)},add(){N.add(this)}};return c.add(),c};var Ee=G+U,ue=function(e,t,n,o){if(typeof o=="string"){let a=document.querySelector(o);if(!a)throw new Error("query not found");let u=C.get(a);if(u&&u===e)return a;C.set(a,e)}else if(o instanceof Element||o instanceof ShadowRoot){let a=C.get(o);if(a&&a===e)return o;C.set(o,e)}let s=[],l=e.content.cloneNode(!0),c=document.createTreeWalker(l,Ee,null),r,i=0;for(;c.nextNode();){r=c.currentNode;let a=r.nodeType;if(a===Z){let u=r,x=u.nodeValue?.indexOf(n)??-1;if(x===-1)continue;x!==0&&(u.splitText(x),r=c.nextNode(),u=r);let m=n.length;m!==u.nodeValue?.length&&u.splitText(m);let b=y(u),f=v(4,i++,t,b);s.unshift(f)}else if(a===J){let u=r,x=u.tagName;(x==="STYLE"||x==="SCRIPT")&&c.nextSibling();let m;if(q(x,n)){m=y(r);let f=v(1,i++,t,m);s.unshift(f)}let b=u.getAttributeNames();for(let f of b){let $=u.getAttribute(f)??"",H=q(f,n),W=te($,n);if(H||W){if(m=m??y(r),H&&W){let g=y(""),S=y(""),E=v(2,i++,t,m,g,S),pe=v(3,i++,t,m,g,S);u.removeAttribute(f),s.unshift(E),s.unshift(pe)}else if(H){let g=y(""),S=y($),E=v(2,i++,t,m,g,S);u.removeAttribute(f),s.unshift(E)}else if(W){let g=y(f),S=y(""),E=v(3,i++,t,m,g,S);u.removeAttribute(f),s.unshift(E)}}else w(f)?B($)&&(u.removeAttribute(f),console.warn(`attribute name "${f}" and value "${$}" not allowed`)):d(f)&&(u.removeAttribute(f),console.warn(`attribute name "${f}" not allowed`))}}else console.warn(`walker node type "${a}" not handled`)}for(let a of s)L(a);if(typeof o=="string"){let a=document.querySelector(o);if(!a)throw new Error("query not found");return X(a,l),a}else return o instanceof Element||o instanceof ShadowRoot?(X(o,l),o):l};var fe=function(e){return e=e.replace(/([a-zA-Z])([A-Z])/g,"$1-$2"),e=e.toLowerCase(),e=e.includes("-")?e:`x-${e}`,e};var Ce=function(e,t){return function(n){let o=fe(e),s=t;customElements.define(o,n,{extends:s})}};var me=new WeakMap,ke=function(e){if(e.shadowRoot){let t=document.getRootNode();e.shadowRoot.adoptedStyleSheets.push(...t.adoptedStyleSheets);for(let n of t.styleSheets){let o=me.get(n);if(!o){o=new CSSStyleSheet;let{cssRules:s}=n;for(let{cssText:l}of s)o.insertRule(l);me.set(n,o)}e.shadowRoot.adoptedStyleSheets.push(o)}}};var St=function(e,...t){let n,o,s=_.get(e);if(s)n=s.marker,o=s.template;else{n=ne();let c="",r=e.length-1;for(let i=0;i<r;i++)c+=`${e[i]}${n}`;c+=e[r],o=document.createElement("template"),o.innerHTML=c,_.set(e,{template:o,marker:n})}let l={[p]:!0,[h]:n,[j]:o,[F]:t};return Object.assign(ue.bind(l,o,t,n),l)};export{Ce as define,St as html,ke as style,V as update,Se as updateAllSync};
//# sourceMappingURL=es2021.min.js.map
